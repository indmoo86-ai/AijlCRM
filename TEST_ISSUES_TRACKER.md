# 测试问题跟踪清单

**创建日期**: 2025-12-28
**测试工具**: Playwright (Headless Chrome)
**测试人员**: Claude AI

---

## 测试执行概览

| 模块 | 场景数 | 通过 | 失败 | 跳过 | 进度 |
|------|--------|------|------|------|------|
| 用户认证 | 2 | 2 | 0 | 0 | **100%** |
| 产品管理 | 6 | 1 | 0 | 0 | 进行中 |
| 客户管理 | 7 | 0 | 0 | 0 | 待测试 |
| 线索管理 | 8 | 1 | 0 | 0 | 进行中 |
| 报价单管理 | 7 | 0 | 0 | 0 | 待测试 |
| 合同管理 | 10 | 0 | 0 | 0 | 待测试 |
| 任务管理 | 8 | 0 | 0 | 0 | 待测试 |
| 发货管理 | 8 | 0 | 0 | 0 | 待测试 |
| 收款管理 | 8 | 0 | 0 | 0 | 待测试 |
| 发票管理 | 8 | 0 | 0 | 0 | 待测试 |
| 售后服务 | 9 | 0 | 0 | 0 | 待测试 |
| **总计** | **79** | **4** | **0** | **0** | **5%** |

---

## 已通过测试场景

### 场景1.1: 用户登录 ✅
- **测试时间**: 2025-12-28 23:59
- **测试结果**: 通过
- **验证点**:
  - ✅ 访问系统首页正确跳转到登录页
  - ✅ 用户名输入框正常
  - ✅ 密码输入框正常
  - ✅ 登录按钮可点击
  - ✅ 使用正确密码(123456)登录成功
  - ✅ 登录后跳转到工作台(/dashboard)
  - ✅ 右上角显示用户名"系统管理员"
- **截图**: `1.1-step6-after-login_*.png`

### 场景1.2: 错误密码登录 ✅
- **测试时间**: 2025-12-28 23:59
- **测试结果**: 通过
- **验证点**:
  - ✅ 输入错误密码后点击登录
  - ✅ 系统返回401错误
  - ✅ 页面仍停留在登录页
  - ✅ 显示错误提示消息
- **截图**: `1.2-after-click_*.png`

### 场景4.1: 创建产品（完整测试） ✅
- **测试时间**: 2025-12-29 00:18
- **测试结果**: 通过（修复BUG后）
- **验证点**:
  - ✅ 成功导航到产品管理页面(/products)
  - ✅ 新建按钮可点击
  - ✅ 新建产品对话框正确显示
  - ✅ 填写所有表单字段（产品编码、名称、品牌、分类、单位、价格、状态、描述）
  - ✅ 点击确定按钮保存成功
  - ✅ 显示"创建成功"提示
  - ✅ 产品数据成功写入数据库
  - ✅ 产品在列表中正确显示
- **截图**: `4.1-step5-list-after-create_*.png`
- **修复的BUG**: ISSUE-004 产品列表数据字段不匹配

### 场景2.1: 创建线索（完整测试） ✅
- **测试时间**: 2025-12-29 00:21
- **测试结果**: 通过
- **验证点**:
  - ✅ 成功导航到线索管理页面(/leads)
  - ✅ 新建按钮可点击
  - ✅ 新建线索对话框正确显示
  - ✅ 填写所有表单字段（客户名称、酒店名称、省份、城市、房间数、联系电话、来源渠道、意向程度、预估金额、需求描述）
  - ✅ 点击确定按钮保存成功
  - ✅ 线索数据成功写入数据库
  - ✅ 线索在列表中正确显示
- **截图**: `2.1-step5-list-after-create_*.png`
- **预修复BUG**: ISSUE-005 线索列表数据字段不匹配（同ISSUE-004）

---

## 待修复问题清单

### 格式说明

每个问题记录包含：
- **问题编号**: ISSUE-XXX
- **场景编号**: 对应的测试场景
- **问题描述**: 详细描述问题
- **截图**: 相关截图路径
- **修复尝试次数**: 当前已尝试修复次数
- **修复状态**: 待修复 / 修复中 / 已修复 / 已跳过
- **修复记录**: 每次修复的详细记录

---

## 问题详情

### 已修复问题

#### ISSUE-001: 登录按钮选择器错误
- **场景**: 1.1
- **问题**: 测试脚本使用 `button[type="submit"]` 选择器，但登录按钮是 `el-button` 组件，没有该属性
- **修复**: 改用 `button:has-text("登录")` 选择器
- **状态**: ✅ 已修复
- **修复次数**: 1

#### ISSUE-002: 测试密码与数据库不匹配
- **场景**: 1.1
- **问题**: 前端显示默认密码是 `admin123`，但数据库中实际密码是 `123456`
- **修复**: 测试脚本使用正确密码 `123456`
- **状态**: ✅ 已修复
- **修复次数**: 1
- **备注**: 建议同步更新前端显示的默认密码

#### ISSUE-003: URL判断逻辑错误
- **场景**: 1.1
- **问题**: 检查 `includes('/dashboard')` 误判 `/login?redirect=/dashboard` 为已登录
- **修复**: 增加条件 `&& !currentUrl.includes('/login')`
- **状态**: ✅ 已修复
- **修复次数**: 1

#### ISSUE-004: 产品列表数据字段不匹配
- **场景**: 4.1
- **问题**: 前端代码使用 `res.data.rows` 获取产品列表，但API返回的是 `res.data.list`
- **影响**: 产品创建成功后，列表显示"暂无数据"
- **修复文件**: `frontend/src/views/products/Index.vue` 第350-351行
- **修复内容**:
  ```javascript
  // 修复前
  tableData.value = res.data.rows || []
  pagination.total = res.data.total || 0

  // 修复后
  tableData.value = res.data.list || res.data.rows || []
  pagination.total = res.data.pagination?.total || res.data.total || 0
  ```
- **状态**: ✅ 已修复
- **修复次数**: 1

---

## 测试截图目录

截图保存位置: `/Users/robin/claude code/AijlCRM/test-screenshots/`

主要截图:
- `1.1-step6-after-login_*.png` - 登录成功后的工作台
- `1.2-after-click_*.png` - 错误密码登录被拒绝
- `4.1-step2-add-dialog_*.png` - 新建产品对话框
- `2.1-step2-add-dialog_*.png` - 新建线索对话框

---

## 修复策略

1. **首次修复**: 直接根据错误信息修复
2. **第2-3次修复**: 仔细分析问题原因，尝试不同方案
3. **第4-6次修复**: 重新查阅需求文档和测试文档，审视问题
4. **第7-8次修复**: 考虑重构相关代码
5. **超过8次**: 记录为已跳过，继续下一个测试

---

## 更新日志

- 2025-12-28 23:40: 创建测试问题跟踪文件
- 2025-12-28 23:59: 场景1.1、1.2测试通过
- 2025-12-29 00:01: 场景4.1测试通过
- 2025-12-29 00:03: 场景2.1测试通过
- 已修复3个问题（ISSUE-001~003）
