# 艾居来 CRM 系统 E2E 测试计划

## 测试环境准备

### 前置条件
- ✅ 前端服务运行：http://localhost:5173
- ✅ 后端服务运行：http://localhost:3000
- ✅ 数据库已初始化
- ✅ 测试账号已创建（或使用系统默认管理员账号）

### 测试账号
- 用户名：admin
- 密码：123456（根据实际情况调整）

---

## 测试场景清单

### 场景 1：用户登录流程
**目标**：验证用户能够成功登录系统

**测试步骤**：
1. 访问登录页面 http://localhost:5173/login
2. 输入用户名：admin
3. 输入密码：123456
4. 点击登录按钮
5. 验证跳转到工作台页面
6. 验证顶部显示用户信息

**预期结果**：
- ✅ 成功登录
- ✅ 跳转到 /dashboard
- ✅ 显示用户名和头像

---

### 场景 2：线索管理完整流程
**目标**：创建线索 → 跟进线索 → 转为客户

**测试步骤**：

#### 2.1 创建线索
1. 点击侧边栏"线索管理"
2. 点击"添加线索"按钮
3. 填写表单：
   - 线索名称：测试酒店-E2E-001
   - 联系人：张经理
   - 手机号：13800138001
   - 来源：网络推广
   - 状态：新线索
4. 点击"确定"按钮
5. 验证列表中显示新创建的线索

#### 2.2 跟进线索
1. 在线索列表中找到"测试酒店-E2E-001"
2. 点击"跟进"按钮
3. 填写跟进内容：初次电话沟通，客户有意向
4. 选择下次联系时间
5. 点击"确定"
6. 验证跟进记录已添加

#### 2.3 转为客户
1. 点击"转客户"按钮
2. 确认转换操作
3. 验证跳转到客户列表
4. 验证客户列表中显示新转换的客户

**预期结果**：
- ✅ 线索创建成功
- ✅ 跟进记录保存成功
- ✅ 成功转为客户
- ✅ 客户信息完整

---

### 场景 3：产品管理流程
**目标**：创建产品并管理产品信息

**测试步骤**：

#### 3.1 创建产品
1. 点击侧边栏"产品管理"
2. 点击"添加产品"按钮
3. 填写表单：
   - 产品编码：PROD-E2E-001
   - 产品名称：智能门锁套装
   - 产品类别：智能硬件
   - 规格型号：DL-2024-Pro
   - 单位：套
   - 成本价：800
   - 销售价：1200
   - 库存数量：100
   - 状态：上架
4. 点击"确定"
5. 验证产品列表中显示新产品

#### 3.2 查看产品详情
1. 点击产品名称或详情按钮
2. 验证显示完整的产品信息
3. 点击返回

**预期结果**：
- ✅ 产品创建成功
- ✅ 产品信息显示正确
- ✅ 可以正常查看详情

---

### 场景 4：报价单管理流程
**目标**：创建报价单 → 添加产品明细 → 提交报价

**测试步骤**：

#### 4.1 创建报价单
1. 点击侧边栏"报价管理"
2. 点击"新建报价单"按钮
3. 填写表单：
   - 报价单号：（自动生成）
   - 客户：选择"测试酒店-E2E-001"
   - 有效期至：选择30天后
   - 备注：E2E测试报价单
4. 点击"确定"
5. 验证跳转到报价单详情页

#### 4.2 添加产品明细
1. 在报价单详情页，点击"添加产品"按钮
2. 选择产品：智能门锁套装
3. 输入数量：50
4. 输入单价：1200（自动填充）
5. 输入折扣率：5
6. 验证小计自动计算：50 × 1200 × (1-0.05) = 57,000
7. 点击"确定"
8. 验证产品明细列表显示该产品
9. 验证表格底部合计金额正确

#### 4.3 提交报价单
1. 点击"提交报价"按钮
2. 确认提交
3. 验证状态变为"已提交"
4. 验证"添加产品"按钮不可用（已提交状态不可编辑）

**预期结果**：
- ✅ 报价单创建成功
- ✅ 产品明细添加成功
- ✅ 金额计算正确
- ✅ 提交后状态更新
- ✅ 草稿状态可编辑，提交后不可编辑

---

### 场景 5：合同管理完整流程
**目标**：从报价单转合同 → 添加产品明细 → 签署合同 → 查看执行进度

**测试步骤**：

#### 5.1 创建合同
1. 点击侧边栏"合同管理"
2. 点击"新建合同"按钮
3. 填写表单：
   - 合同编号：（自动生成）
   - 客户：选择"测试酒店-E2E-001"
   - 合同金额：57000
   - 付款方式：预付款
   - 交付方式：物流配送
4. 点击"确定"
5. 验证跳转到合同详情页

#### 5.2 添加产品明细
1. 点击"添加产品"按钮
2. 选择产品：智能门锁套装
3. 输入数量：50
4. 输入单价：1200
5. 输入折扣率：5
6. 验证小计：57,000
7. 点击"确定"
8. 验证产品清单显示正确

#### 5.3 签署合同
1. 点击"签署合同"按钮
2. 选择签订日期：今天
3. 选择生效日期：今天
4. 选择到期日期：1年后
5. 点击"确定签署"
6. 验证状态变为"执行中"
7. 验证"查看进度"按钮可用

#### 5.4 查看执行进度
1. 点击"查看进度"按钮
2. 验证显示进度对话框
3. 验证显示：
   - 合同金额
   - 已发货金额（初始为0）
   - 已收款金额（初始为0）
   - 已开票金额（初始为0）
   - 完成比例
4. 点击关闭

**预期结果**：
- ✅ 合同创建成功
- ✅ 产品明细添加成功
- ✅ 合同签署成功
- ✅ 状态流转正确
- ✅ 执行进度显示正确

---

### 场景 6：附件管理流程
**目标**：在合同详情页上传和管理附件

**测试步骤**：

#### 6.1 上传附件
1. 在合同详情页滚动到"附件管理"部分
2. 点击"上传附件"按钮
3. 选择文件（准备一个测试PDF文件）
4. 等待上传完成
5. 验证附件列表显示新上传的文件
6. 验证显示：文件名、大小、上传时间、上传人

#### 6.2 下载附件
1. 找到上传的附件
2. 点击"下载"按钮
3. 验证文件下载成功

#### 6.3 删除附件
1. 点击"删除"按钮
2. 确认删除
3. 验证附件从列表中移除

**预期结果**：
- ✅ 附件上传成功
- ✅ 附件信息显示正确
- ✅ 下载功能正常
- ✅ 删除功能正常

---

### 场景 7：任务管理流程
**目标**：创建任务 → 开始任务 → 完成任务

**测试步骤**：

#### 7.1 创建任务
1. 点击侧边栏"任务中心"
2. 点击"新建任务"按钮
3. 填写表单：
   - 任务标题：完成测试酒店的产品安装
   - 任务类型：客户拜访
   - 优先级：高
   - 截止日期：3天后
   - 任务描述：前往客户现场进行设备安装调试
4. 点击"确定"
5. 验证任务列表显示新任务

#### 7.2 开始任务
1. 找到刚创建的任务
2. 点击"开始"按钮
3. 验证状态变为"进行中"

#### 7.3 完成任务
1. 点击"完成"按钮
2. 填写完成备注
3. 点击"确定"
4. 验证状态变为"已完成"

**预期结果**：
- ✅ 任务创建成功
- ✅ 状态流转正确
- ✅ 任务统计数字更新

---

### 场景 8：个人中心功能
**目标**：修改个人信息和密码

**测试步骤**：

#### 8.1 访问个人中心
1. 点击顶部用户头像
2. 选择"个人中心"
3. 验证显示个人信息卡片

#### 8.2 修改个人信息
1. 修改姓名：测试管理员
2. 修改手机号：13800138888
3. 修改部门：技术部
4. 点击"保存信息"
5. 验证保存成功提示

#### 8.3 查看账户统计
1. 验证显示统计数据：
   - 我的线索数量
   - 我的客户数量
   - 我的报价数量
   - 我的合同数量

**预期结果**：
- ✅ 个人信息显示正确
- ✅ 修改保存成功
- ✅ 统计数据显示正确

---

### 场景 9：系统设置功能
**目标**：管理用户和角色

**测试步骤**：

#### 9.1 访问系统设置
1. 点击侧边栏"系统设置"
2. 验证显示三个标签页：用户管理、角色管理、系统参数

#### 9.2 创建新用户
1. 切换到"用户管理"标签页
2. 点击"添加用户"按钮
3. 填写表单：
   - 用户名：test_sales
   - 姓名：测试销售
   - 邮箱：test@example.com
   - 手机号：13900139001
   - 角色：销售人员
   - 密码：Test123456
4. 点击"确定"
5. 验证用户列表显示新用户

#### 9.3 修改系统参数
1. 切换到"系统参数"标签页
2. 修改"报价单有效期"为45天
3. 点击"保存设置"
4. 验证保存成功

**预期结果**：
- ✅ 系统设置页面加载正常
- ✅ 用户创建成功
- ✅ 参数修改保存成功

---

### 场景 10：工作台数据可视化
**目标**：验证工作台图表显示

**测试步骤**：

1. 点击侧边栏"工作台"
2. 验证显示4个统计卡片：
   - 线索数量
   - 客户数量
   - 待处理任务
   - 月度合同金额
3. 验证显示5个图表：
   - 销售漏斗图
   - 业绩趋势图
   - 任务状态图
   - 客户类型分布图
   - 产品排行图
4. 点击"周/月/季"切换按钮
5. 验证图表数据更新

**预期结果**：
- ✅ 统计卡片显示正确
- ✅ 图表渲染正常
- ✅ 数据切换功能正常
- ✅ 快速操作按钮可用

---

## 测试数据清理

测试完成后，清理测试数据：
1. 删除测试创建的任务
2. 删除测试创建的合同
3. 删除测试创建的报价单
4. 删除测试创建的产品
5. 删除测试创建的客户
6. 删除测试创建的线索
7. 删除测试创建的用户

---

## 测试报告模板

### 测试执行记录

| 场景编号 | 场景名称 | 执行时间 | 执行结果 | 问题描述 | 截图 |
|---------|---------|---------|---------|---------|------|
| 1 | 用户登录流程 | 2025-12-26 | ✅ 通过 | - | - |
| 2 | 线索管理完整流程 | 2025-12-26 | ⚠️ 部分通过 | 跟进记录保存失败 | screenshot_1.png |
| 3 | 产品管理流程 | 2025-12-26 | ✅ 通过 | - | - |
| ... | ... | ... | ... | ... | ... |

### 问题汇总

| 问题编号 | 严重程度 | 问题描述 | 复现步骤 | 状态 |
|---------|---------|---------|---------|------|
| BUG-001 | 高 | 跟进记录保存失败 | 1. 创建线索 2. 点击跟进 3. 填写内容 4. 点击确定 | 待修复 |
| BUG-002 | 中 | 报价单金额计算精度问题 | ... | 待修复 |

### 测试覆盖率

- 核心功能覆盖率：100%
- 页面覆盖率：95%
- 业务流程覆盖率：100%

### 测试结论

✅ 通过：8个场景
⚠️ 部分通过：2个场景
❌ 失败：0个场景

总体评价：系统基本功能正常，存在少量需要修复的问题。
